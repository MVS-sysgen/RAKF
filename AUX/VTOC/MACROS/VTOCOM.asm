         MACRO
         VTOCOM  &TYPE
*
*        THIS IS THE VTOC COMMAND COMMON AREA
*
         AIF   ('&TYPE' EQ 'NODSECT').NODSECT
VTOCOM   DSECT
         AGO   .NODS
.NODSECT ANOP
VTOCOM   DS    0D
.NODS    ANOP
*
*        WORKING STORAGE AREAS FOR THE VARIOUS ROUTINES
*
VTCWMSG  DS    A              WORKING STORAGE FOR THE MSG  ROUTINE
VTCWEXIT DS    A              WORKING STORAGE FOR THE EXIT ROUTINE
VTCWEXCP DS    A              WORKING STORAGE FOR THE EXCP ROUTINE
VTCWCHEK DS    A              WORKING STORAGE FOR THE CHEK ROUTINE
VTCWFORM DS    A              WORKING STORAGE FOR THE FORM ROUTINE
VTCWPRNT DS    A              WORKING STORAGE FOR THE PRNT ROUTINE
VTCWSORT DS    A              WORKING STORAGE FOR THE SORT ROUTINE
*
*        ADDRESSES OF THE ROUTINES
*
VADMSG   DC    V(VTOCMSG)     ADDRESS OF THE MESSAGE ROUTINE
VADEXIT  DC    V(VTOCEXIT)    ADDRESS OF THE EXIT ROUTINE
VADEXCP  DC    V(VTOCEXIT)    ADDRESS OF THE EXCP ROUTINE
VADCHEK  DC    V(VTOCEXIT)    ADDRESS OF THE CHECK ROUTINE
VADFORM  DC    V(VTOCEXIT)    ADDRESS OF THE FORMAT ROUTINE
VADPRNT  DC    V(VTOCEXIT)    ADDRESS OF THE PRINT ROUTINE
VADSORT  DC    V(VTOCEXIT)    ADDRESS OF THE SORT ROUTINE
*
*        TSO COMMAND PROCESSOR AND PARSE DATA
*
ADDRUPT  DS    A              USER PROFILE TABLE
ADDRECT  DS    A              ENVIRONMENT CONTROL TABLE
ADDRPSCB DS    A              PROTECTED STEP CONTROL BLOCK
ADDRCBUF DS    A              COMMAND BUFFER
         SPACE
ADDRANSR DS    A              PARSE ANSWER OR PDL ADDRESS
         SPACE
PARMLIST DS    8A             INTERNAL PARM AREA ( MSG )
ATTNECB  DS    F              ECB FOR ATTENTIONS
DOUBLE   DS    D
         SPACE
MSGADDRS DS    2A             ADDRESSES OF MESSAGES FOR VTOCMSG
MSGTEXT1 DS    XL124
MSGTEXT2 DS    XL124
         SPACE 3
PUTOLD1  DS    3F
PUTOLD2  DS    3F
*
*        PARAMETER LIST FOR THE EXIT ROUTINE
*
EXITLIST DS    0F
EXITAREA DS    A       WORKAREA LOCATION
DSCBADDR DS    A       ADDRESS OF THE DSCB
FORMATAD DS    A       ADDRESS OF THE FORMATTED DSCB
CPPLADDR DS    A       ADDRESS OF THE CPPL
ACTIONAD DS    A       ADDRESS OF THE RECOMMENDED OR REQUESTED ACTION
*
*        INTER ROUTINE FLAGS
*
VTCEFUNC DS    X              VTOCEXCP FUNCTION FLAG
VTCFMTCK DS    X              FORMAT IS CALLED BY CHECK RTN
VTCFMTCD EQU   X'80'          FORMAT WAS CALLED BY CHECK
VTCFMTCC EQU   X'08'          FORMAT WAS CALLED BY CHECK THIS CALL
*
TABFULL  DS    X             FLAG TABLES FULL, STOP INPUT
LOCAT    DS    X              FLAG TO PERFORM CATALOG LOCATE
VTCEPRNT DS    X               PRINT END AND CLEANUP FLAG
DSNLEN   DS    H              LENGTH OF THE DSNAME (NON-BLANKS)
ATABTITL DS    A              ADDRESS OF TABLE OF TITLES, LENGTHS
*
*
*
*        WORKING STORAGE FOR VOLUME UCB SEARCH
*
ADDR     DS    CL3     UCB ADDRESS IN CHARACTERS
VOLSER   DS    CL6     VOLUME SERIAL NUMBER FROM PARSE
VOLID    DS    CL6     CURRENT VOLUME SERIAL NUMBER TO PROCESS
FLAG     DS    X       UCB SEARCH FLAG
LASTADR  DS    F       LAST UCB ADDRESS FOUND ( NO DUP'S )
*
*
*
SORTTAB  DS    16F
*
* EACH ENTRY CONTAINS A KEY OFFSET (2 BYTES) AND A KEY LENGTH (2 BYTES)
* THIS TABLE IS BUILT AT PARSE TIME ACCORDING TO THE SORT PARAMETERS
* SPECIFIED. THE 1ST PARM IS THE HIGH KEY AND SO ON.
*
*
*
*        ADDRESSES OF GETMAIN FOR FORMATTED DATA
*
VTCCURAD DS    A             CURRENT AVAILABLE ADDRESS
VTCCURLN DS    A             CURRENT AVAILABLE LENGTH
VTCGETMN DS    50A           ADDRESSES OF BLOCKS
VTCGETMX EQU  (*-VTCGETMN)/4  NUMBER OF BLOCKS  MAXIMUM
VTCGETMS EQU   32768          GETMAIN SIZE
*
*        HASH SORT TABLE, POINTERS TO FIRST ENTRIES
*
VTCSORTH DS    256A           POINT TO FORMATED ENTRIES
VTCSORTE EQU   *              END OF LIST
*
*        PRINT ENTRIES - PAGE AND LINE COUNTERS
*
LINECT   DS    H              LINE COUNT
LINEMAX  DS    H              MAXIMUM LINES PER PAGE
PAGECT   DS    H              PAGE COUNT
LINELEN  DS    H              LENGTH OF THE PRINT LINE
*
*
*          VARIOUS ITEMS
*
FMT4     DS    XL44           SPACE FOR DSCB NAME
         IECSDSL1 4          SAVE EACH FORMAT 4 DSCB
         DS    0D
FMT3     DS    0XL148         SPACE FOR FORMAT3 DSCB
         IECSDSL1 3
         DS    9XL148         SUPPORT UP TO 123 DASD EXTENTS    ABL-ICF
UCBPARMS DS    3A             PARMS FOR UCB SCAN SERVICES       ABL-UCB
UCBANSR  DS    A              RESULT UCB ADDRESS                ABL-UCB
         DS    0D                                               ABL-UCB
UCBWORK  DS    CL100          UCB SCAN WORK AREA                ABL-UCB
         DS    0D
         MEND
